{% extends 'recipe/base.html' %}
{% load static %}
{% block content %}

<div class="container-fluid h-100vh scrollable">
    <div class="row mt-3">
        <div class="col-2 mb-5">
            <a href="{% url 'recipe:databases' %}" class="btn btn-info">Retour</a>
        </div>
    </div>
    <div class="container mb-5">
        <div class="row border-box content-sign_in fix-height">
            <div class="col-12">
                {% if recipe %}
                <div class="d-none">
                    <div id="dataCategs">
                        {% for categ in categs %}
                        <i data-id="{{ categ.pk }}" data-name="{{ categ.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="allFoods">
                        {% for food in foods %}
                        <i data-id="{{ food.pk }}" data-name="{{ food.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="allUtensils">
                        {% for utensil in utensils %}
                        <i data-id="{{ utensil.pk }}" data-name="{{ utensil.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataPriceScale">
                        {% for price in price_scale %}
                        <i data-id="{{ price.pk }}" data-name="{{ price.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataLevels">
                        {% for level in levels %}
                        <i data-id="{{ level.pk }}" data-name="{{ level.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataOrigins">
                        {% for origin in origins %}
                        <i data-id="{{ origin.pk }}" data-name="{{ origin.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataDiets">
                        {% for diet in diets %}
                        <i data-id="{{ diet.pk }}" data-name="{{ diet.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataAllergies">
                        {% for allergie in allergies %}
                        <i data-id="{{ allergie.pk }}" data-name="{{ allergie.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataSeasons">
                        {% for season in seasons %}
                        <i data-id="{{ season.pk }}" data-name="{{ season.name }}"></i>
                        {% endfor %}
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-4 col-form-label">
                        <div id="imgBloc">
                            <img src="{{ recipe.image.url }}" alt="picture-{{ recipe.name }}" class="img-fluid" id="imgRecipe">
                        </div>
                        <div class="d-flex justify-content-around">
                            <button type="button" class="btn btn-primary btn-sm" id="btnChangeImage"><i class="fas fa-image"></i> <i class="fas fa-sync-alt"></i></button>
                            <button type="button" class="btn btn-secondary btn-sm d-none" id="btnCancleNewImage"><i class="fas fa-times"></i></button>
                            <button type="button" class="btn btn-success btn-sm d-none" id="btnSaveNewImage"><i class="fas fa-check"></i></button>
                        </div>
                    </div>
                    <div class="col-sm-8 d-flex justify-content-between align-items-center">
                        <h3 class="form-control-plaintext" id="nameRecipe">{{ recipe.name }}</h3>
                        <div class="btn-bloc-edit d-flex justify-content-around align-items-center">
                            <button type="button" class="btn btn-primary btn-sm" id="btnEditRecipe">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipePrepareDuration" class="col-sm-4 col-form-label border-label">Temps de preparation</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipePrepareDuration">{{ recipe.preparation_time }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeCookingTime" class="col-sm-4 col-form-label border-label">Temps de cuisson</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipeCookingTime">{{ recipe.cooking_time }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-4 col-form-label border-label">
                        <label for="RecipeFoodQuant">Aliments et quantités</label>
                        <button type="button" class="btn btn-success btn-sm" id="btnAddFoods" data-toggle="modal" data-target="#searchFoodModal">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="col-sm-8" id="divFoods">
                        <ul id="listingFoods">
                            {% for r_food in recipe.get_all_foods %}
                            <li id="li-{{ r_food.food.pk }}" data-food-id="{{ r_food.food.pk }}" data-recipe-quant="{{ r_food.recipe_quantity }}" data-recipe-unit="{{ r_food.recipe_unity }}" data-purchase-quant="{{ r_food.food_purchase_quantity }}" data-purchase-unit="{{ r_food.food_purchase_unity }}"><a href="/recipe/detail/food/{{ r_food.food.pk }}">{{ r_food.food.name }}</a> <strong>{{ r_food.recipe_quantity }} {{ r_food.recipe_unity }}</strong></li>
                            {% endfor %}
                        </ul>
                        <table class="table table-bordered table-sm d-none" id="allUsedFoods">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col">Nom</th>
                                    <th scope="col">Quantité Recette</th>
                                    <th scope="col">Unité Recette</th>
                                    <th scope="col">Quantité Achat</th>
                                    <th scope="col">Unité Achat</th>
                                    <th scope="col">#</th>
                                </tr>
                            </thead>
                            <tbody id="updatedFoods">
                                
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeStep" class="col-sm-4 col-form-label border-label">Étapes de la recette</label>
                    <div class="col-sm-8">
                        <ol id="listingSteps">
                            {% for step in recipe.get_step %}
                            <li>{{ step }}</li>
                            {% endfor %}
                        </ol>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeTip" class="col-sm-4 col-form-label border-label">Astuces pour la recette</label>
                    <div class="col-sm-8">
                        <ol id="listingTips">
                            {% for tip in recipe.get_tip %}
                            <li>{{ tip }}</li>
                            {% endfor %}
                        </ol>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeCateg" class="col-sm-4 col-form-label border-label">Catégorie de la recette</label>
                    <div class="col-sm-8">
                        <ul id="RecipeCateg">
                            {% for categ in recipe.categories.all %}
                            <li>{{ categ.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Nombre de portions</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipePortion">{{ recipe.portion }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Nombre de points</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipePoint">{{ recipe.point }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Fourchette de prix</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipePriceScale">{{ recipe.price_scale.name }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeSource" class="col-sm-4 col-form-label border-label">Source de la recette</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipeSource">{{ recipe.source }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeLevel" class="col-sm-4 col-form-label border-label">Niveau de difficultée</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipeLevel">{{ recipe.level.name }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeOrigin" class="col-sm-4 col-form-label border-label">Origine de la recette</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipeOrigin">{{ recipe.origin.name }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeAtypical" class="col-sm-4 col-form-label border-label">Recette typique de la ville de</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="RecipeTypical">{{ recipe.typical_recipe_city }}</P>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeSeason" class="col-sm-4 col-form-label border-label">Saison(s) de la recette</label>
                    <div class="col-sm-8">
                        <ul id="RecipeSeason">
                            {% for season in recipe.season.all %}
                            <li>{{ season.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeDiet" class="col-sm-4 col-form-label border-label">Régime(s) alimentaire de la recette</label>
                    <div class="col-sm-8">
                        <ul id="RecipeDiet">
                            {% for diet in recipe.dietary_plan.all %}
                            <li>{{ diet.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="RecipeAllerg" class="col-sm-4 col-form-label border-label">Allergie(s) possible pour la recette</label>
                    <div class="col-sm-8">
                        <ul id="RecipeAllerg">
                            {% for allergie in recipe.allergies.all %}
                            <li>{{ allergie.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-4 col-form-label border-label">
                        <label for="RecipeFoodQuant">Ustensiles de cuisine</label>
                        <button type="button" class="btn btn-success btn-sm" id="btnModalUtensils" data-toggle="modal" data-target="#utensilModal">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="col-sm-8" id="divUtensils">
                        <ul id="RecipeUtensils">
                            {% for r_utensil in recipe.utensils.all %}
                            <li data-utensil_id="{{ r_utensil.pk }}">{{ r_utensil.name }}</li>
                            {% endfor %}
                        </ul>
                        <table class="table table-bordered table-sm d-none" id="tableUpdatedUtensils">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col">Nom</th>
                                    <th scope="col">#</th>
                                </tr>
                            </thead>
                            <tbody id="allUsedUtensils">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="form-group row" id="formActions">
                    <label for="validationUpdated" class="col-sm-4 col-form-label border-label">Actions sur le formulaire</label>
                    <div class="col-sm-8 d-flex justify-content-around align-items-center">
                        <button type="button" class="btn btn-secondary btn-sm" id="btnCancelEdit">
                            <i class="fas fa-times"></i>
                            Annuler
                        </button>
                        <button type="button" class="btn btn-success btn-sm" id="btnSaveEdit">
                            <i class="fas fa-check"></i>
                            Valider
                        </button>
                    </div>
                </div>
                <!-- Modal add utensils -->
                <div class="modal fade" id="utensilModal" tabindex="-1" aria-labelledby="utensilModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="utensilModal">Recherche d'ustensiles de cuisine</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="searchUtensil">
                                            <i class="fas fa-search-plus"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="Chercher un ustensile" aria-label="SearchUtensil" aria-describedby="searchUtensil" id="searchUtensilInput">
                                </div>
                                <div class="display-result form-group row" id="searchUtensilResult">
                                    <div class="col-sm-4 d-flex-between">
                                        <label for="utensilsResult">
                                            Sélectionner un ou plusieurs ustensile(s) 
                                            <small>
                                                (utiliser la touche Shift ou Ctrl pour faire une sélection multiple et 
                                                <strong class="text-info">cliquer sur le bouton bleu pour valider</strong> )
                                            </small>
                                        </label>
                                        <button type="button" class="btn btn-info btn-valid-quantity" id="btnAddUtensil" disabled>Valider</button>
                                    </div>
                                    <div class="col-sm-8">
                                        <select name="utensils" class="h-30vh form-control" id="utensilsResult" multiple>
                                            {% for utensil in utensils %}
                                            <option value="{{ utensil.pk }}:{{ utensil.name }}">{{ utensil.name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="col-sm-4 mt-5">
                                        <p>Ustensiles ajoutés</p>
                                    </div>
                                    <div class="col-sm-8 mt-5">
                                        <table class="table table-bordered table-sm">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th scope="col">Nom</th>
                                                    <th scope="col">#</th>
                                                </tr>
                                            </thead>
                                            <tbody class="my-d-none" id="selectedUtensils">
                                                
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-danger" id="btnUtensilClear">Tout effacer</button>
                                <button type="button" class="btn btn-success" data-dismiss="modal" id="btnValideSearchUtensil">Sauvegarder</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal search food -->
                <div class="modal fade" id="searchFoodModal" tabindex="-1" aria-labelledby="searchFoodModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="searchFoodModal">Recherche d'ingrédients</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="searchFood">
                                            <i class="fas fa-search-plus"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="Chercher un aliment" aria-label="SearchFood" aria-describedby="searchFood" id="searchInput">
                                </div>
                                <div class="display-result form-group row" id="searchResult">
                                    <div class="col-sm-4 d-flex-between">
                                        <label for="foodsResult">
                                            Sélectionner un ou plusieurs ingrédients 
                                            <small>
                                                (utiliser la touche Shift ou Ctrl pour faire une sélection multiple et 
                                                <strong class="text-info">cliquer sur le bouton bleu pour valider</strong> )
                                            </small>
                                        </label>
                                        <button type="button" class="btn btn-info btn-valid-quantity" id="btnAddFood" disabled>Valider</button>
                                    </div>
                                    <div class="col-sm-8">
                                        <select name="foods" class="h-30vh" id="foodsResult" multiple>
                                        </select>
                                    </div>
                                    <div class="col-sm-4 mt-3 d-flex-between">
                                        <label for="quantityFormBloc">
                                            Quantité souhaitée 
                                            <small>(la saisie sera possible une fois que vous aurez validé votre sélection via le bouton bleu)</small>
                                        </label>
                                        <button class="btn btn-success btn-valid-quantity" id="btnValideFormQuantity" disabled>Valider</button>
                                    </div>
                                    <div class="col-sm-8 mt-3">
                                        <div class="my-d-none" id="quantityFormBloc">

                                        </div>
                                    </div>
                                    <div class="col-12 mt-5">
                                        <p class="text-center mb-3 lead">Ingédients ajoutés</p>
                                        <table class="table table-bordered table-sm">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th scope="col">Nom</th>
                                                    <th scope="col">Quantité Recette</th>
                                                    <th scope="col">Unité Recette</th>
                                                    <th scope="col">Quantité Achat</th>
                                                    <th scope="col">Unité Achat</th>
                                                    <th scope="col">#</th>
                                                </tr>
                                            </thead>
                                            <tbody class="my-d-none" id="selectedFoods">
                                                
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-danger" id="btnClear">Tout effacer</button>
                                <button type="button" class="btn btn-success" data-dismiss="modal" id="btnValideSearch">Sauvegarder</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% elif foodgroup %}
                <div class="form-group row">
                    <label for="nameGroup" class="col-sm-4 col-form-label"> </label>
                    <div class="col-sm-8">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="form-control-plaintext" id="nameGroup">{{ foodgroup.name }}</h3>
                            <button class="btn btn-primary" id="btnEditUnit">Modifier l'unité de mesure des ingrédients</button>
                        </div>
                        <div class="my-3 d-none" id="blocEditUnit" data-id-group="{{ foodgroup.pk }}">
                            <div class="d-flex align-items-center mb-3">
                                <i class="text-danger fas fa-exclamation-triangle mr-2"></i>
                                <p class="text-danger"><strong>Attention, vérifier bien que tous les ingrédients listés ici, peuvent porter la même unité !!!</strong></p>
                                <i class="text-danger fas fa-exclamation-triangle ml-2"></i>
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="selectUnit">Choisissez l'unité</span>
                                </div>
                                <select name="unit" id="typeUnit" class="form-control">
                                    <option value="null">------------</option>
                                    <option value="fr:g (gramme);en:lb (pound)">Gramme (EN: Pond)</option>
                                    <option value="fr:l (litre);en:pt (pint)">Litre (EN: Pint)</option>
                                </select>
                            </div>
                            <div class="d-flex justify-content-end align-items-center">
                                <button class="btn btn-secondary mr-4" id="btnCancelEditUnit">Annuler</button>
                                <button class="btn btn-success" id="btnValideEditUnit">Valider</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="GroupFood" class="col-sm-4 col-form-label border-label">Aliments appartenant au groupe</label>
                    <div class="col-sm-8">
                        <ul>
                            {% for food in foodgroup.food_set.all %}
                            <li><a href="/recipe/detail/food/{{ food.pk }}" class="lead">{{ food.name }}</a> ({{ food.metric_unit }})</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% elif categorierecipe %}
                <div class="form-group row">
                    <div class="col-sm-4 col-form-label">
                        <div id="imgPictoCategRecipeBloc" class="img-bloc img-bloc-picto d-flex justify-content-around">
                            <img src="{{ categorierecipe.try_get_image_active }}" alt="{{ categorierecipe.try_get_image_active }}" class="img-picto-active" id="pictoRecipe">
                            <img src="{{ categorierecipe.try_get_image_not_active }}" alt="{{ categorierecipe.try_get_image_not_active }}" class="img-picto" id="pictoRecipe">
                        </div>
                        <div class="d-flex justify-content-around">
                            <button type="button" class="btn btn-primary btn-sm" id="btnChangeImageCategRecipe"><i class="fas fa-image"></i> <i class="fas fa-sync-alt"></i></button>
                            <button type="button" class="btn btn-secondary btn-sm d-none" id="btnCancleNewImageCategRecipe"><i class="fas fa-times"></i></button>
                            <button type="button" class="btn btn-success btn-sm d-none" id="btnSaveNewImageCategRecipe"><i class="fas fa-check"></i></button>
                        </div>
                    </div>
                    <label for="nameGroup" class="col-sm-4 col-form-label"> </label>
                    <div class="col-sm-8">
                        <h3 class="form-control-plaintext" id="nameGroup">{{ categorierecipe.name }}</h3>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="CategRecipe" class="col-sm-4 col-form-label border-label">Recettes appartenant à cette categorie</label>
                    <div class="col-sm-8">
                        <ul>
                            {% for recipe in categorierecipe.recipe_set.all %}
                            <li><a href="/recipe/detail/recipe/{{ recipe.pk }}" class="lead">{{ recipe.name }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% elif utensil %}
                <div class="form-group row">
                    <label for="nameUtensil" class="col-sm-4 col-form-label">Nom de l'ustensile de cuisine</label>
                    <div class="col-sm-8">
                        <h3 class="form-control-plaintext" id="nameUtensil">{{ utensil.name }}</h3>
                    </div>
                </div>
                {% elif dietaryplan %}
                <div class="form-group row">
                    <label for="nameDiet" class="col-sm-4 col-form-label">Nom du régime alimentaire</label>
                    <div class="col-sm-8">
                        <h3 class="form-control-plaintext" id="nameDiet">{{ dietaryplan.name }}</h3>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="dietPlan" class="col-sm-4 col-form-label border-label">Recettes appartenant à ce régime alimentaire</label>
                    <div class="col-sm-8">
                        <ul>
                            {% for recipe in dietaryplan.recipe_set.all %}
                            <li><a href="/recipe/detail/recipe/{{ recipe.pk }}" class="lead">{{ recipe.name }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% elif originrecipe %}
                <div class="form-group row">
                    <label for="nameOrigin" class="col-sm-4 col-form-label"> </label>
                    <div class="col-sm-8">
                        <h3 class="form-control-plaintext" id="nameOrigin">{{ originrecipe.name }}</h3>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="originRecipe" class="col-sm-4 col-form-label border-label">Recettes appartenant à cette origine</label>
                    <div class="col-sm-8">
                        <ul>
                            {% for recipe in originrecipe.recipe_set.all %}
                            <li><a href="/recipe/detail/recipe/{{ recipe.pk }}" class="lead">{{ recipe.name }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% elif food %}
                <div class="form-group row">
                    <label for="nameFood" class="col-sm-4 col-form-label"> </label>
                    <div class="col-sm-8">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="form-control-plaintext" id="nameFood" data-id-food="{{ food.pk }}">{{ food.name }}</h3>
                            <div class="btn-bloc-edit d-flex justify-content-around align-items-center">
                                <button type="button" class="btn btn-primary btn-sm" id="btnEditFoodName">
                                    <i class="fas fa-pencil-alt"></i>
                                </button>
                                <button type="button" class="btn btn-success btn-sm" id="btnValideData" style="display:none;">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button type="button" class="btn btn-secondary btn-sm" id="btnCancelEdit" style="display:none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <button class="btn btn-primary" id="btnEditUnit">Modifier l'unité de mesure des ingrédients</button>
                        </div>
                        <div class="my-3 d-none" id="blocEditUnit">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="selectUnit">Choisissez l'unité</span>
                                </div>
                                <select name="unit" id="typeUnit" class="form-control">
                                    <option value="null">------------</option>
                                    <option value="fr:g (gramme);en:lb (pound)">Gramme (EN: Pond)</option>
                                    <option value="fr:l (litre);en:pt (pint)">Litre (EN: Pint)</option>
                                </select>
                            </div>
                            <div class="d-flex justify-content-end align-items-center">
                                <button class="btn btn-secondary mr-4" id="btnCancelEditUnit">Annuler</button>
                                <button class="btn btn-success" id="btnValideEditUnit">Valider</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% for field, val in food.list_fields %}
                <div class="form-group row">
                    <label for="descriptionFood" class="col-sm-4 col-form-label border-label">{{ field }}</label>
                    {% if field == "groupe de l'ingredient" %}
                    <div class="col-sm-8">
                        <a href="/recipe/detail/group/{{ food.pk }}" class="form-control-plaintext text-primary" id="descriptionFood">{{ food.id_group.name }}</a>
                    </div>
                    {% else %}
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="descriptionFood">{{ val }}</p>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                {% elif planning %}
                <div class="d-none">
                    <div id="dataOrigins">
                        {% for origin in origins %}
                        <i data-id="{{ origin.pk }}" data-name="{{ origin.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataDiets">
                        {% for diet in diets %}
                        <i data-id="{{ diet.pk }}" data-name="{{ diet.name }}"></i>
                        {% endfor %}
                    </div>
                    <div id="dataSeasons">
                        {% for season in seasons %}
                        <i data-id="{{ season.pk }}" data-name="{{ season.name }}"></i>
                        {% endfor %}
                    </div>
                </div>
                <div class="form-group row">
                    <label for="namePlanning" class="col-sm-4 col-form-label">Nom du planning de recette</label>
                    <div class="col-sm-8 d-flex justify-content-center align-items-center">
                        <h3 class="form-control-plaintext mr-5" id="namePlanning" data-id-planning="{{ planning.pk }}">{{ planning.name }}</h3>
                        <button class="btn btn-success mr-3" id="confirmPlanning" disabled><span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true" id="loading"></span> <i class="fas fa-check"></i></button>
                        <button class="btn btn-primary" id="editPlanning"><i class="fas fa-pencil-alt"></i></button>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="id_season_planning" class="col-sm-4 col-form-label border-label">Saison</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="id_season_planning" data-id-season="{{ planning.season.pk }}">{{ planning.season }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="id_origin_planning" class="col-sm-4 col-form-label border-label">Origine</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="id_origin_planning" data-id-origin="{{ planning.origin.pk }}">{{ planning.origin }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="id_diet_planning" class="col-sm-4 col-form-label border-label">Régime alimentaire</label>
                    <div class="col-sm-8">
                        <p class="form-control-plaintext" id="id_diet_planning" data-id-diet="{{ planning.dietary_plan.pk }}">{{ planning.dietary_plan }}</p>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="id_premium_planning" class="col-sm-4 col-form-label border-label">Version pour membre abonné</label>
                    <div class="col-sm-8">
                        {% if planning.premium %}
                        <p class="form-control-plaintext" id="is_premium_planning" data-is-premium="{{ planning.premium }}"><i class="fas fa-check-circle text-success"></i></p>
                        {% else %}
                        <p class="form-control-plaintext" id="is_premium_planning" data-is-premium="{{ planning.premium }}"><i class="fas fa-times-circle text-danger"></i></p>
                        {% endif %}
                    </div>
                </div>
                <table class="table table-striped mt-5">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            {% for mlp in meals_per_day %}
                            <th scope="col" data-mlp-id="{{ mlp.pk }}">{{ mlp.name }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="{{ planning.monday.name }}" data-id-day="{{ planning.monday.pk }}">
                            <th scope="row">{{ planning.monday.name }}</th>
                            {% for day_mlp in planning.monday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.monday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.tuesday.name }}" data-id-day="{{ planning.tuesday.pk }}">
                            <th scope="row">{{ planning.tuesday.name }}</th>
                            {% for day_mlp in planning.tuesday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.tuesday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.wednesday.name }}" data-id-day="{{ planning.wednesday.pk }}">
                            <th scope="row">{{ planning.wednesday.name }}</th>
                            {% for day_mlp in planning.wednesday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.wednesday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.thursday.name }}" data-id-day="{{ planning.thursday.pk }}">
                            <th scope="row">{{ planning.thursday.name }}</th>
                            {% for day_mlp in planning.thursday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.thursday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.friday.name }}" data-id-day="{{ planning.friday.pk }}">
                            <th scope="row">{{ planning.friday.name }}</th>
                            {% for day_mlp in planning.friday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.friday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.saturday.name }}" data-id-day="{{ planning.saturday.pk }}">
                            <th scope="row">{{ planning.saturday.name }}</th>
                            {% for day_mlp in planning.saturday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.saturday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                        <tr id="{{ planning.sunday.name }}" data-id-day="{{ planning.sunday.pk }}">
                            <th scope="row">{{ planning.sunday.name }}</th>
                            {% for day_mlp in planning.sunday.daymealsperday_set.all|dictsort:"pk" %}
                            <td id="{{ planning.sunday.name }}-{{ day_mlp.meal_per_day.pk }}" data-mlp-id="{{ day_mlp.meal_per_day.pk }}">
                                {% for recipe in day_mlp.recipes.all %}
                                <div class="d-flex justify-content-center align-items-center recipe-bloc">
                                    <p class="title-recipe" data-id-recipe="{{ recipe.pk }}">{{ recipe.name }}</p>
                                </div>
                            {% endfor %}
                            </td>
                            {% endfor %}
                        </tr>
                    </tbody>
                </table>
                <!-- Modal -->
                <div class="modal fade" id="modalEditPlanning" tabindex="-1" role="dialog" aria-labelledby="modalEditPlanningTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-scrollable modal-xl modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" data-mlp-id="" id="modalEditPlanningTitle"></h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="update-recipe-bloc-listing">
                                    <p class="lead">Recettes choisies:</p>
                                    <ul id="listingRecipe">

                                    </ul>
                                </div>
                                <div class="d-flex mt-4 justify-content-between align-items-center">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <label class="input-group-text" for="Categories">Categories</label>
                                            </div>
                                            <select class="custom-select" id="categorieFilter">
                                                <option value="" selected>Choisissez...</option>
                                                {% for categ in categs %}
                                                <option value="{{ categ.pk }}">{{ categ.name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="input-group mx-3">
                                            <div class="input-group-prepend">
                                                <label class="input-group-text" for="originFilter">Origine</label>
                                            </div>
                                            <select class="custom-select" id="originFilter">
                                                <option value="" selected>Choisissez...</option>
                                                {% for origin in origins %}
                                                <option value="{{ origin.pk }}">{{ origin.name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <label class="input-group-text" for="dietFilter">Régimes</label>
                                            </div>
                                            <select class="custom-select" id="dietFilter">
                                                <option value="" selected>Choisissez...</option>
                                                {% for diet in diets %}
                                                <option value="{{ diet.pk }}">{{ diet.name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="input-group mx-3">
                                            <div class="input-group-prepend">
                                                <label class="input-group-text" for="Saison">Saison</label>
                                            </div>
                                            <select class="custom-select" id="seasonFilter">
                                                <option value="" selected>Choisissez...</option>
                                                {% for season in seasons %}
                                                <option value="{{ season.pk }}">{{ season.name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mr-3">
                                        <button class="btn btn-success" id="valideFilter"><i class="fas fa-check"></i></button>
                                    </div>
                                    <div>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="inputSearchRecipe" placeholder="Chercher une recette" aria-label="recherche de recette" aria-describedby="basic-addon2">
                                            <div class="input-group-append">
                                                <button type="button" class="input-group-text btn-secondary" id="basic-addon2"><i class="fas fa-search"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid mt-5 pt-3 scrollable-section">
                                    <div class="row" id="displayRecipeBloc">
                                        {% for recipe in recipes %}
                                        <div class="col-12 col-lg-3 mb-3" id="recipeNumber-{{ recipe.pk }}">
                                            <div class="content-card-recipe">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="lead" data-recipe-id="{{ recipe.pk }}" onclick="showModalDetailRecipe(this)">{{ recipe.name }}</p>
                                                    <div class="checkbox-small btn-group btn-group-sm" role="group">
                                                        <button class="btn btn-sm btn-success" id="checkRecipe-{{ recipe.pk }}" data-checked="false"><i class="fas fa-plus"></i></button>
                                                    </div>
                                                </div>
                                                <div class="d-flex mt-2" data-recipe-id="{{ recipe.pk }}" onclick="showModalDetailRecipe(this)">
                                                    <div class="image-bloc">
                                                        <img src="{{ recipe.image.url }}" alt="image of the recipe" class="img-fluid">
                                                    </div>
                                                    <div class="data-recipe">
                                                        <p>{{ recipe.categorie.name }}</p>
                                                        <hr class="hr-data-recipe">
                                                        <p>{% for season in recipe.season.all %}{{ season.name }}, {% endfor %}</p>
                                                        <hr class="hr-data-recipe">
                                                        <p>{% for diet in recipe.dietary_plan.all %}{{ diet.name }}, {% endfor %}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                                <button type="button" class="btn btn-success" data-dismiss="modal" id="saveChangeBtn">Enregistrer les changements</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% for recipe in recipes %}
                <!-- Modal -->
                <div class="modal fade" id="modalRecipe{{ recipe.pk }}" tabindex="-1" role="dialog" aria-labelledby="modalRecipeDetaiTitlel{{ recipe.pk }}" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalRecipeDetailTitle{{ recipe.pk }}">{{ recipe.name }}</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="d-flex mt-2">
                                    <div class="image-bloc image-bloc-modal">
                                        <img src="{{ recipe.image.url }}" alt="image of the recipe" class="img-fluid">
                                    </div>
                                    <div class="row ml-4">
                                        <div class="col-12">
                                            <div class="form-group row">
                                                <label for="prepTime" class="col-sm-4 col-form-label border-label">Temps de préparation</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext">{{ recipe.preparation_time }}</p>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeCookingTime" class="col-sm-4 col-form-label border-label">Temps de cuisson</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeCookingTime">{{ recipe.cooking_time }}</p>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-sm-4 col-form-label border-label">
                                                    <label for="RecipeFoodQuant">Aliments et quantités</label>
                                                </div>
                                                <div class="col-sm-8" id="divFoods">
                                                    <ul id="listingFoods">
                                                        {% for r_food in recipe.get_all_foods %}
                                                        <li data-food_id="{{ r_food.food.pk }}">{{ r_food.food.name }} <strong>{{ r_food.quantity }}</strong></li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeStep" class="col-sm-4 col-form-label border-label">Étapes de la recette</label>
                                                <div class="col-sm-8">
                                                    <ol id="listingSteps">
                                                        {% for step in recipe.get_step %}
                                                        <li>{{ step }}</li>
                                                        {% endfor %}
                                                    </ol>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeTip" class="col-sm-4 col-form-label border-label">Astuces pour la recette</label>
                                                <div class="col-sm-8">
                                                    <ol id="listingTips">
                                                        {% for tip in recipe.get_tip %}
                                                        <li>{{ tip }}</li>
                                                        {% endfor %}
                                                    </ol>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeCateg" class="col-sm-4 col-form-label border-label">Catégorie de la recette</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeCateg" data-id_categ="{{ recipe.categorie.pk }}">{{ recipe.categorie.name }}</p>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Nombre de portions</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipePortion">{{ recipe.portion }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Nombre de points</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipePoint">{{ recipe.point }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipePriceScale" class="col-sm-4 col-form-label border-label">Fourchette de prix</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipePriceScale">{{ recipe.price_scale.name }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeSource" class="col-sm-4 col-form-label border-label">Source de la recette</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeSource">{{ recipe.source }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeLevel" class="col-sm-4 col-form-label border-label">Niveau de difficultée</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeLevel">{{ recipe.level.name }}</p>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeOrigin" class="col-sm-4 col-form-label border-label">Origine de la recette</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeOrigin">{{ recipe.origin.name }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeAtypical" class="col-sm-4 col-form-label border-label">Recette typique de la ville de</label>
                                                <div class="col-sm-8">
                                                    <p class="form-control-plaintext" id="RecipeTypical">{{ recipe.typical_recipe_city }}</P>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeSeason" class="col-sm-4 col-form-label border-label">Saison(s) de la recette</label>
                                                <div class="col-sm-8">
                                                    <ul id="RecipeSeason">
                                                        {% for season in recipe.season.all %}
                                                        <li>{{ season.name }}</li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="RecipeDiet" class="col-sm-4 col-form-label border-label">Régime(s) alimentaire de la recette</label>
                                                <div class="col-sm-8">
                                                    <ul id="RecipeDiet">
                                                        {% for diet in recipe.dietary_plan.all %}
                                                        <li>{{ diet.name }}</li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-sm-4 col-form-label border-label">
                                                    <label for="RecipeFoodQuant">Ustensiles de cuisine</label>
                                                </div>
                                                <div class="col-sm-8" id="divUtensils">
                                                    <ul id="RecipeUtensils">
                                                        {% for r_utensil in recipe.utensils.all %}
                                                        <li data-utensil_id="{{ r_utensil.pk }}">{{ r_utensil.name }}</li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block script %}
<script src="{% static 'user/js/secureajax.js' %}"></script>
<script src="{% static 'user/js/parsedRequestData.js' %}"></script>
{% if recipe %}
<script src="{% static 'user/js/getFoodsTable.js' %}"></script>
<script src="{% static 'user/js/getUtensilsTable.js' %}"></script>
<script src="{% static 'user/js/updateRecipe.js' %}"></script>
<script src="{% static 'user/js/updateRecipeImage.js' %}"></script>
<script src="{% static 'user/js/addUtensils.js' %}"></script>
{% elif planning%}
<script src="{% static 'planning/js/updatePlanning.js' %}"></script>
{% elif food %}
<script src="{% static 'user/js/updateFood.js' %}"></script>
<script src="{% static 'user/js/editFoodUnit.js' %}"></script>
{% elif foodgroup %}
<script src="{% static 'user/js/editFoodGroupUnit.js' %}"></script>
{% elif categorierecipe %}
<script src="{% static 'user/js/updatePictoCategRecipe.js' %}"></script>
{% endif %}
<script src="{% static 'user/js/script.js' %}"></script>
{% endblock script %}